#import the modules
import os
import pandas as pd

#read the csv file into a dataframe
file_path = "/home/ubuntu/cs179g_venv/src/jsonfiles/"

#list all the files from the directory
file_list = os.listdir(file_path)

file_list = ['10_29_hot_comments.json', '11_01_hot_comments.json', '11_01_top_comments_day.json', 
             '11_01_top_comments_week.json', '11_21_hot_comments.json', '11_21_top_comments_day.json', 
             '11_21_top_comments_week.json', 'controversial_comments.json', 'controversial_comments_day.json', 
             'controversial_comments_hour.json', 'controversial_comments_month.json', 'controversial_comments_week.json', 
             'controversial_comments_year.json', 'flicks_top_all_comments.json', 'flicks_top_year_comments.json', 
             'hot_comments.json', 'netflixbestof_controversial_comments_all.json', 'netflixbestof_controversial_comments_year.json', 
             'netflixbestof_hot_comments.json', 'netflixbestof_top_all_comments.json', 'netflixbestof_top_year_comments.json', 
             'top_comments.json', 'top_comments_day.json', 'top_comments_hour.json', 'top_comments_month.json', 
             'top_comments_week.json', 'top_comments_year.json', 'true_top_comments.json', 'true_top_comments_year.json']

df_concat = pd.concat([pd.read_json(file_path + f) for f in file_list ], ignore_index=True)
df_concat = df_concat.drop(index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 30, 31, 43, 48, 52, 55, 58, 60, 70, 78, 81, 95, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 174, 176, 177, 178, 179, 181, 183, 184, 185, 186, 187, 188, 190, 191, 192, 193, 194, 196, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 439, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 475, 476, 477, 478, 479, 480, 482, 484, 485, 486, 487, 488, 493, 494, 495, 496, 497, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 809, 811, 828, 832, 833, 836, 843, 859, 875, 881, 882, 886, 888, 889, 893, 894, 897, 898, 901, 904, 905, 907, 909, 910, 911, 912, 917, 921, 925, 926, 927, 930, 936, 938, 943, 954, 957, 961, 969, 972, 976, 977, 984, 987, 993, 994, 995, 996, 1001, 1003, 1005, 1006, 1010, 1014, 1019, 1020, 1021, 1024, 1025, 1029, 1036, 1041, 1042, 1045, 1046, 1047, 1051, 1060, 1066, 1074, 1077, 1080, 1086, 1088, 1089, 1090, 1091, 1092, 1093, 1133, 1194, 1199, 1200, 1205, 1207, 1217, 1222, 1229, 1231, 1233, 1236, 1238, 1248, 1250, 1252, 1253, 1254, 1255, 1266, 1267, 1274, 1276, 1285, 1290, 1394, 1395, 1396, 1397, 1398, 1399, 1400, 1402, 1403, 1404, 1405, 1406, 1407, 1408, 1409, 1410, 1411, 1412, 1414, 1417, 1419, 1423, 1426, 1431, 1432, 1433, 1434, 1435, 1438, 1439, 1443, 1446, 1448, 1449, 1450, 1460, 1472, 1483, 1490, 1491, 1530, 1531, 1541, 1578, 1588, 1601, 1619, 1621, 1641, 1643, 1659, 1676, 1685, 1694, 1702, 1704, 1761, 1835, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2019, 2103, 2104, 2105, 2106, 2107, 2108, 2109, 2110, 2111, 2112, 2113, 2122, 2123, 2130, 2133, 2138, 2140, 2143, 2144, 2145, 2155, 2162, 2174, 2176, 2177, 2183, 2187, 2188, 2189, 2191, 2195, 2196, 2202, 2205, 2209, 2221, 2225, 2227, 2234, 2247, 2249, 2252, 2263, 2265, 2272, 2273, 2299, 2301, 2303, 2516, 2517, 2527, 2534, 2535, 2537, 2538, 2545, 2546, 2552, 2559, 2562, 2565, 2570, 2573, 2575, 2576, 2579, 2580, 2594])

df = pd.DataFrame()
df['Combo'] = df_concat[df_concat.columns].astype(str).apply(lambda x: ', '.join(x), axis = 1)

df.to_csv("all_comments.tsv", index=False, sep="\t")
